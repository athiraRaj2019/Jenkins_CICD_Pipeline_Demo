
Pipeline
********

pipeline{
    agent any
    
    stages{
        stage('CloneSources'){
            steps{
                git url:'https://github.com/athiraRaj2019/SimpleMavenJunitWebApp.git'
            }
        }
        
        stage('Build'){
            steps{
                sh 'mvn clean install'
            }
        }
        
        stage('SonarAnalysis'){
            steps{
                withSonarQubeEnv('mysonar'){
                    sh 'mvn sonar:sonar'
                }
            }
        }
        
        stage('Publish'){
            steps{
               sh "curl -v -u admin:admin123 --upload-file /var/lib/jenkins/workspace/pipelineTest2/target/SimpleMavenJunitWebApp.war http://localhost:8081/repository/POC-repo/" 
            }
        }
         
        stage('Deploy'){
            steps{
               sh'''
               cd /opt/tomcat/apache-tomcat-8.5.40/webapps
               wget http://localhost:8081/repository/POC-repo/SimpleMavenJunitWebApp.war -O /opt/tomcat/apache-tomcat-8.5.40/webapps/SimpleMavenJunitWebApp.war
               '''
            }
        }
    }
}
